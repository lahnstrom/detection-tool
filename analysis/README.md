# Clinical Trial Results Detection Analysis

This repository contains code for analyzing the detection of clinical trial results through various methods including publications and registry data.

This README.md file was generated by Cluade 3.5 Sonnet.

## Directory Structure

```
Root
├── code/           # Source code files
├── data/           # Input data files (CSV)
└── out/
    ├── figures/    # Generated plots and charts
    └── manually_curated/  # Manually created visualizations
```

## Source Files

### Data Processing

- `0-validation-dataset.R`: Creates validation datasets by combining IntoValue and Nordic clinical trials data. Handles data cleaning and preparation.

- `1-processing_ctgov.R`: Processes ClinicalTrials.gov data to:
  - Filter for interventional studies
  - Handle completion dates
  - Create year and enrollment bins
  - Generate random samples for analysis

### Analysis & Visualization

- `2a-flowcharts.R`: Generates flowcharts using DiagrammeR showing:

  - Detection tool logic
  - Study inclusion/exclusion criteria
  - Sample selection process

- `2b-tool_perf.R`: Evaluates tool performance metrics including:

  - Sensitivity/specificity analysis
  - Confusion matrix generation
  - Performance across different identification methods

- `2c-results.R`: Performs main results analysis:

  - Publication detection rates
  - Logistic regression for enrollment and completion year
  - Chi-square tests for various study characteristics
  - Generates visualization plots

- `2d-demographics.R`: Analyzes and visualizes study demographics:

  - Enrollment distributions
  - Completion year trends
  - Study phase distributions
  - Funding source analysis

- `2e-smalheiser.R`: Analyzes the Smalheiser dataset for validation purposes

## Output

### Figures Directory

Contains programmatically generated visualizations:

- Logistic regression plots
- Enrollment distribution charts
- Year distribution plots
- Demographics visualizations
- Performance metric charts

### Manually Curated Directory

Contains manually created or adjusted visualizations for specific use cases.

## Usage

1. Ensure all required R packages are installed:

   ```R
   required_packages <- c("dplyr", "stringr", "DiagrammeR", "DiagrammeRsvg",
                         "rsvg", "ggplot2", "scales", "patchwork", "lubridate",
                         "presize", "data.table")
   new_packages <- required_packages[!(required_packages %in% installed.packages()[,"Package"])]
   if(length(new_packages)) install.packages(new_packages)
   ```

2. Run scripts in numerical order:

   - Start with `0-validation-dataset.R`
   - Follow with `1-processing_ctgov.R`
   - Then run analysis scripts (`2a` through `2e`)

3. Check the `out/figures` directory for generated visualizations

## Data Requirements

The following input files are expected in the `data` directory:

- `iv_main_dataset.csv`: IntoValue dataset
- `nordic_dataset.csv`: Nordic trials dataset
- `ctg-studies-all-completed-terminated-2024-10-24.csv`: ClinicalTrials.gov data. This has to be downloaded from clinicaltrials.gov.
- `smalheiser_.95.csv`: Smalheiser validation dataset
- Various validation run files (e.g., `validation_run_all_1.csv`)
